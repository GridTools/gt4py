<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>gt4py.eve.utils &mdash; GT4Py 1.0.0 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/cscs.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> GT4Py
            <img src="../../../_static/logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.0.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">GT4Py: GridTools for Python</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart.html">Quick Start Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../gtscript.html">GTScript Language Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../arrays.html">Allocation and Array Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../lang_design.html">GTScript Language Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../commandline.html">Commandline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../apiref.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../indices.html">Indices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../GDPs/gdp-index.html">GT4Py Development</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">GT4Py</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">gt4py.eve.utils</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for gt4py.eve.utils</h1><div class="highlight"><pre>
<span></span><span class="c1"># GT4Py - GridTools Framework</span>
<span class="c1">#</span>
<span class="c1"># Copyright (c) 2014-2022, ETH Zurich</span>
<span class="c1"># All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># This file is part of the GT4Py project and the GridTools framework.</span>
<span class="c1"># GT4Py is free software: you can redistribute it and/or modify it under</span>
<span class="c1"># the terms of the GNU General Public License as published by the</span>
<span class="c1"># Free Software Foundation, either version 3 of the License, or any later</span>
<span class="c1"># version. See the LICENSE.txt file at the top-level directory of this</span>
<span class="c1"># distribution for a copy of the license or check &lt;https://www.gnu.org/licenses/&gt;.</span>
<span class="c1">#</span>
<span class="c1"># SPDX-License-Identifier: GPL-3.0-or-later</span>

<span class="sd">&quot;&quot;&quot;General utility functions. Some functionalities are directly imported from dependencies.&quot;&quot;&quot;</span>


<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="kn">import</span> <span class="nn">collections.abc</span>
<span class="kn">import</span> <span class="nn">dataclasses</span>
<span class="kn">import</span> <span class="nn">enum</span>
<span class="kn">import</span> <span class="nn">functools</span>
<span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">operator</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">pprint</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">types</span>
<span class="kn">import</span> <span class="nn">typing</span>
<span class="kn">import</span> <span class="nn">uuid</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">import</span> <span class="nn">deepdiff</span>  <span class="c1"># type: ignore[import]</span>
<span class="kn">import</span> <span class="nn">xxhash</span>  <span class="c1"># type: ignore[import]</span>
<span class="kn">from</span> <span class="nn">boltons.iterutils</span> <span class="kn">import</span> <span class="n">flatten</span> <span class="k">as</span> <span class="n">flatten</span>  <span class="c1"># type: ignore[import]  # noqa: F401</span>
<span class="kn">from</span> <span class="nn">boltons.iterutils</span> <span class="kn">import</span> <span class="n">flatten_iter</span> <span class="k">as</span> <span class="n">flatten_iter</span>  <span class="c1"># type: ignore[import]  # noqa: F401</span>
<span class="kn">from</span> <span class="nn">boltons.iterutils</span> <span class="kn">import</span> <span class="n">is_collection</span> <span class="k">as</span> <span class="n">is_collection</span>  <span class="c1"># type: ignore[import]  # noqa: F401</span>
<span class="kn">from</span> <span class="nn">boltons.strutils</span> <span class="kn">import</span> <span class="n">a10n</span> <span class="k">as</span> <span class="n">a10n</span>  <span class="c1"># type: ignore[import]  # noqa: F401</span>
<span class="kn">from</span> <span class="nn">boltons.strutils</span> <span class="kn">import</span> <span class="n">asciify</span> <span class="k">as</span> <span class="n">asciify</span>  <span class="c1"># type: ignore[import]  # noqa: F401</span>
<span class="kn">from</span> <span class="nn">boltons.strutils</span> <span class="kn">import</span> <span class="p">(</span>  <span class="c1"># type: ignore[import]  # noqa: F401</span>
    <span class="n">format_int_list</span> <span class="k">as</span> <span class="n">format_int_list</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">boltons.strutils</span> <span class="kn">import</span> <span class="p">(</span>  <span class="c1"># type: ignore[import]  # noqa: F401</span>
    <span class="n">iter_splitlines</span> <span class="k">as</span> <span class="n">iter_splitlines</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">boltons.strutils</span> <span class="kn">import</span> <span class="n">parse_int_list</span> <span class="k">as</span> <span class="n">parse_int_list</span>  <span class="c1"># type: ignore[import]  # noqa: F401</span>
<span class="kn">from</span> <span class="nn">boltons.strutils</span> <span class="kn">import</span> <span class="n">slugify</span> <span class="k">as</span> <span class="n">slugify</span>  <span class="c1"># type: ignore[import]  # noqa: F401</span>
<span class="kn">from</span> <span class="nn">boltons.strutils</span> <span class="kn">import</span> <span class="n">unwrap_text</span> <span class="k">as</span> <span class="n">unwrap_text</span>  <span class="c1"># type: ignore[import]  # noqa: F401</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">extended_typing</span> <span class="k">as</span> <span class="n">xtyping</span>
<span class="kn">from</span> <span class="nn">.extended_typing</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">Any</span><span class="p">,</span>
    <span class="n">Callable</span><span class="p">,</span>
    <span class="n">Collection</span><span class="p">,</span>
    <span class="n">Dict</span><span class="p">,</span>
    <span class="n">Generic</span><span class="p">,</span>
    <span class="n">Iterable</span><span class="p">,</span>
    <span class="n">Iterator</span><span class="p">,</span>
    <span class="n">List</span><span class="p">,</span>
    <span class="n">Literal</span><span class="p">,</span>
    <span class="n">Optional</span><span class="p">,</span>
    <span class="n">ParamSpec</span><span class="p">,</span>
    <span class="n">Set</span><span class="p">,</span>
    <span class="n">Tuple</span><span class="p">,</span>
    <span class="n">Type</span><span class="p">,</span>
    <span class="n">TypeVar</span><span class="p">,</span>
    <span class="n">Union</span><span class="p">,</span>
    <span class="n">overload</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">.type_definitions</span> <span class="kn">import</span> <span class="n">NOTHING</span><span class="p">,</span> <span class="n">NothingType</span>


<span class="k">try</span><span class="p">:</span>
    <span class="c1"># For perfomance reasons, try to use cytoolz when possible (using cython)</span>
    <span class="kn">import</span> <span class="nn">cytoolz</span> <span class="k">as</span> <span class="nn">toolz</span>  <span class="c1"># type: ignore[import]</span>
<span class="k">except</span> <span class="ne">ModuleNotFoundError</span><span class="p">:</span>
    <span class="c1"># Fall back to pure Python toolz</span>
    <span class="kn">import</span> <span class="nn">toolz</span>  <span class="c1"># type: ignore[import]  # noqa: F401</span>


<span class="n">T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="isinstancechecker"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.isinstancechecker">[docs]</a><span class="k">def</span> <span class="nf">isinstancechecker</span><span class="p">(</span><span class="n">type_info</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Type</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Type</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Return a callable object that checks if operand is an instance of `type_info`.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; checker = isinstancechecker((int, str))</span>
<span class="sd">        &gt;&gt;&gt; checker(3)</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; checker(&#39;3&#39;)</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; checker(3.3)</span>
<span class="sd">        False</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">types</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Type</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">type_info</span><span class="p">,</span> <span class="nb">type</span><span class="p">):</span>
        <span class="n">types</span> <span class="o">=</span> <span class="p">(</span><span class="n">type_info</span><span class="p">,)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">type_info</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="n">is_collection</span><span class="p">(</span><span class="n">type_info</span><span class="p">):</span>
        <span class="n">types</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">type_info</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">types</span> <span class="o">=</span> <span class="n">type_info</span>  <span class="c1"># type:ignore  # it is checked at run-time</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">types</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">types</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid type(s) definition: &#39;</span><span class="si">{</span><span class="n">types</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="k">lambda</span> <span class="n">obj</span><span class="p">:</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">types</span><span class="p">)</span></div>


<div class="viewcode-block" id="attrchecker"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.attrchecker">[docs]</a><span class="k">def</span> <span class="nf">attrchecker</span><span class="p">(</span><span class="o">*</span><span class="n">names</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Return a callable object that checks if operand has all `names` attributes.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from collections import namedtuple</span>
<span class="sd">        &gt;&gt;&gt; Point = namedtuple(&#39;Point&#39;, [&#39;x&#39;, &#39;y&#39;])</span>
<span class="sd">        &gt;&gt;&gt; point = Point(1.0, 2.0)</span>
<span class="sd">        &gt;&gt;&gt; checker = attrchecker(&#39;x&#39;)</span>
<span class="sd">        &gt;&gt;&gt; checker(point)</span>
<span class="sd">        True</span>

<span class="sd">        &gt;&gt;&gt; checker = attrchecker(&#39;x&#39;, &#39;y&#39;)</span>
<span class="sd">        &gt;&gt;&gt; checker(point)</span>
<span class="sd">        True</span>

<span class="sd">        &gt;&gt;&gt; checker = attrchecker(&#39;z&#39;)</span>
<span class="sd">        &gt;&gt;&gt; checker(point)</span>
<span class="sd">        False</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Arguments with invalid attribute names: &#39;</span><span class="si">{</span><span class="n">names</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">obj</span><span class="p">:</span> <span class="nb">all</span><span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">)</span></div>


<div class="viewcode-block" id="attrgetter_"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.attrgetter_">[docs]</a><span class="k">def</span> <span class="nf">attrgetter_</span><span class="p">(</span><span class="o">*</span><span class="n">names</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">NOTHING</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Return a callable object that gets `names` attributes from its operand.</span>

<span class="sd">    Similar to :func:`operator.attrgetter()` but accepts a default value.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from collections import namedtuple</span>
<span class="sd">        &gt;&gt;&gt; Point = namedtuple(&#39;Point&#39;, [&#39;x&#39;, &#39;y&#39;])</span>
<span class="sd">        &gt;&gt;&gt; point = Point(1.0, 2.0)</span>
<span class="sd">        &gt;&gt;&gt; getter = attrgetter_(&#39;x&#39;)</span>
<span class="sd">        &gt;&gt;&gt; getter(point)</span>
<span class="sd">        1.0</span>

<span class="sd">        &gt;&gt;&gt; import math</span>
<span class="sd">        &gt;&gt;&gt; getter = attrgetter_(&#39;z&#39;, default=math.nan)</span>
<span class="sd">        &gt;&gt;&gt; getter(point)</span>
<span class="sd">        nan</span>

<span class="sd">        &gt;&gt;&gt; import math</span>
<span class="sd">        &gt;&gt;&gt; getter = attrgetter_(&#39;x&#39;, &#39;y&#39;, &#39;z&#39;, default=math.nan)</span>
<span class="sd">        &gt;&gt;&gt; getter(point)</span>
<span class="sd">        (1.0, 2.0, nan)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Attribute names must be strings (provided: </span><span class="si">{</span><span class="n">names</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">default</span> <span class="ow">is</span> <span class="n">NOTHING</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">operator</span><span class="o">.</span><span class="n">attrgetter</span><span class="p">(</span><span class="o">*</span><span class="n">names</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">def</span> <span class="nf">_getter_with_defaults</span><span class="p">(</span><span class="n">obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="k">def</span> <span class="nf">_getter_with_defaults</span><span class="p">(</span><span class="n">obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">_getter_with_defaults</span></div>


<div class="viewcode-block" id="getitem_"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.getitem_">[docs]</a><span class="k">def</span> <span class="nf">getitem_</span><span class="p">(</span><span class="n">obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">NOTHING</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Return the value of `obj` at index `key`.</span>

<span class="sd">    Similar to :func:`operator.getitem()` but accepts a default value.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; d = {&#39;a&#39;: 1}</span>
<span class="sd">        &gt;&gt;&gt; getitem_(d, &#39;a&#39;)</span>
<span class="sd">        1</span>

<span class="sd">        &gt;&gt;&gt; d = {&#39;a&#39;: 1}</span>
<span class="sd">        &gt;&gt;&gt; getitem_(d, &#39;b&#39;, &#39;default&#39;)</span>
<span class="sd">        &#39;default&#39;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">default</span> <span class="ow">is</span> <span class="n">NOTHING</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">obj</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">obj</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">default</span>

    <span class="k">return</span> <span class="n">result</span></div>


<div class="viewcode-block" id="itemgetter_"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.itemgetter_">[docs]</a><span class="k">def</span> <span class="nf">itemgetter_</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">NOTHING</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Return a callable object that gets `key` item from its operand.</span>

<span class="sd">    Similar to :func:`operator.itemgetter()` but accepts a default value.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; d = {&#39;a&#39;: 1}</span>
<span class="sd">        &gt;&gt;&gt; getter = itemgetter_(&#39;a&#39;)</span>
<span class="sd">        &gt;&gt;&gt; getter(d)</span>
<span class="sd">        1</span>

<span class="sd">        &gt;&gt;&gt; d = {&#39;a&#39;: 1}</span>
<span class="sd">        &gt;&gt;&gt; getter = itemgetter_(&#39;b&#39;, &#39;default&#39;)</span>
<span class="sd">        &gt;&gt;&gt; getter(d)</span>
<span class="sd">        &#39;default&#39;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">obj</span><span class="p">:</span> <span class="n">getitem_</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">)</span></div>


<span class="n">_P</span> <span class="o">=</span> <span class="n">ParamSpec</span><span class="p">(</span><span class="s2">&quot;_P&quot;</span><span class="p">)</span>


<span class="nd">@overload</span>
<span class="k">def</span> <span class="nf">optional_lru_cache</span><span class="p">(</span>
    <span class="n">func</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">maxsize</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">128</span><span class="p">,</span> <span class="n">typed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Callable</span><span class="p">[</span><span class="n">_P</span><span class="p">,</span> <span class="n">_T</span><span class="p">]],</span> <span class="n">Callable</span><span class="p">[</span><span class="n">_P</span><span class="p">,</span> <span class="n">_T</span><span class="p">]]:</span>
    <span class="o">...</span>


<span class="nd">@overload</span>
<span class="k">def</span> <span class="nf">optional_lru_cache</span><span class="p">(</span>  <span class="c1"># noqa: F811  # redefinition of unused function</span>
    <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="n">_P</span><span class="p">,</span> <span class="n">_T</span><span class="p">],</span> <span class="o">*</span><span class="p">,</span> <span class="n">maxsize</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">128</span><span class="p">,</span> <span class="n">typed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[</span><span class="n">_P</span><span class="p">,</span> <span class="n">_T</span><span class="p">]:</span>
    <span class="o">...</span>


<div class="viewcode-block" id="optional_lru_cache"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.optional_lru_cache">[docs]</a><span class="k">def</span> <span class="nf">optional_lru_cache</span><span class="p">(</span>  <span class="c1"># noqa: F811  # redefinition of unused function</span>
    <span class="n">func</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[</span><span class="n">_P</span><span class="p">,</span> <span class="n">_T</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">maxsize</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">128</span><span class="p">,</span> <span class="n">typed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Callable</span><span class="p">[</span><span class="n">_P</span><span class="p">,</span> <span class="n">_T</span><span class="p">],</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Callable</span><span class="p">[</span><span class="n">_P</span><span class="p">,</span> <span class="n">_T</span><span class="p">]],</span> <span class="n">Callable</span><span class="p">[</span><span class="n">_P</span><span class="p">,</span> <span class="n">_T</span><span class="p">]]]:</span>
    <span class="sd">&quot;&quot;&quot;Wrap :func:`functools.lru_cache` to fall back to the original function if arguments are not hashable.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; @optional_lru_cache(typed=True)</span>
<span class="sd">        ... def func(a, b):</span>
<span class="sd">        ...     print(f&quot;Inside func({a}, {b})&quot;)</span>
<span class="sd">        ...     return a + b</span>
<span class="sd">        ...</span>
<span class="sd">        &gt;&gt;&gt; print(func(1, 3))</span>
<span class="sd">        Inside func(1, 3)</span>
<span class="sd">        4</span>
<span class="sd">        &gt;&gt;&gt; print(func(1, 3))</span>
<span class="sd">        4</span>
<span class="sd">        &gt;&gt;&gt; print(func([1], [3]))</span>
<span class="sd">        Inside func([1], [3])</span>
<span class="sd">        [1, 3]</span>
<span class="sd">        &gt;&gt;&gt; print(func([1], [3]))</span>
<span class="sd">        Inside func([1], [3])</span>
<span class="sd">        [1, 3]</span>

<span class="sd">    Notes:</span>
<span class="sd">        Based on :func:`typing._tp_cache`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_decorator</span><span class="p">(</span><span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="n">_P</span><span class="p">,</span> <span class="n">_T</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[</span><span class="n">_P</span><span class="p">,</span> <span class="n">_T</span><span class="p">]:</span>
        <span class="n">cached</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="n">maxsize</span><span class="p">,</span> <span class="n">typed</span><span class="o">=</span><span class="n">typed</span><span class="p">)(</span><span class="n">func</span><span class="p">)</span>

        <span class="nd">@functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">cached</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">error</span><span class="o">.</span><span class="n">args</span> <span class="ow">and</span> <span class="n">error</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;unhashable&quot;</span><span class="p">):</span>
                    <span class="c1"># Catch errors due to non-hashable arguments and fallback to original function</span>
                    <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">error</span>

        <span class="k">return</span> <span class="n">inner</span>

    <span class="k">return</span> <span class="n">_decorator</span><span class="p">(</span><span class="n">func</span><span class="p">)</span> <span class="k">if</span> <span class="n">func</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_decorator</span></div>


<div class="viewcode-block" id="register_subclasses"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.register_subclasses">[docs]</a><span class="k">def</span> <span class="nf">register_subclasses</span><span class="p">(</span><span class="o">*</span><span class="n">subclasses</span><span class="p">:</span> <span class="n">Type</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Type</span><span class="p">],</span> <span class="n">Type</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Class decorator to automatically register virtual subclasses.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import abc</span>
<span class="sd">        &gt;&gt;&gt; class MyVirtualSubclassA:</span>
<span class="sd">        ...     pass</span>
<span class="sd">        ...</span>
<span class="sd">        &gt;&gt;&gt; class MyVirtualSubclassB:</span>
<span class="sd">        ...    pass</span>
<span class="sd">        ...</span>
<span class="sd">        &gt;&gt;&gt; @register_subclasses(MyVirtualSubclassA, MyVirtualSubclassB)</span>
<span class="sd">        ... class MyBaseClass(abc.ABC):</span>
<span class="sd">        ...    pass</span>
<span class="sd">        ...</span>
<span class="sd">        &gt;&gt;&gt; issubclass(MyVirtualSubclassA, MyBaseClass) and issubclass(MyVirtualSubclassB, MyBaseClass)</span>
<span class="sd">        True</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_decorator</span><span class="p">(</span><span class="n">base_cls</span><span class="p">:</span> <span class="n">Type</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">subclasses</span><span class="p">:</span>
            <span class="n">base_cls</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">base_cls</span>

    <span class="k">return</span> <span class="n">_decorator</span></div>


<span class="n">_T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_T&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="noninstantiable"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.noninstantiable">[docs]</a><span class="k">def</span> <span class="nf">noninstantiable</span><span class="p">(</span><span class="bp">cls</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">_T</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">_T</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Make a class without abstract method non-instantiable (subclasses should be instantiable).&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="nb">type</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Non-type value (</span><span class="si">{</span><span class="bp">cls</span><span class="si">}</span><span class="s2">) passed to &#39;noninstantiable()&#39; class decorator.&quot;</span><span class="p">)</span>

    <span class="n">original_init</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="fm">__init__</span>

    <span class="k">def</span> <span class="nf">_noninstantiable_init</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">_T</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span> <span class="ow">is</span> <span class="bp">cls</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Trying to instantiate &#39;</span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; non-instantiable class.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">original_init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="bp">cls</span><span class="o">.</span><span class="fm">__init__</span> <span class="o">=</span> <span class="n">_noninstantiable_init</span>  <span class="c1"># type: ignore[assignment]</span>
    <span class="bp">cls</span><span class="o">.</span><span class="n">__noninstantiable__</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># type: ignore[attr-defined]</span>

    <span class="k">return</span> <span class="bp">cls</span></div>


<div class="viewcode-block" id="is_noninstantiable"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.is_noninstantiable">[docs]</a><span class="k">def</span> <span class="nf">is_noninstantiable</span><span class="p">(</span><span class="bp">cls</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">_T</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Return True if `model` is a non-instantiable class.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;__noninstantiable__&quot;</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="vm">__dict__</span></div>


<div class="viewcode-block" id="content_hash"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.content_hash">[docs]</a><span class="k">def</span> <span class="nf">content_hash</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">hash_algorithm</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">xtyping</span><span class="o">.</span><span class="n">HashlibAlgorithm</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Stable content-based hash function using instance serialization data.</span>

<span class="sd">    It provides a customizable hash function for any kind of data.</span>
<span class="sd">    Unlike the builtin `hash` function, it is stable (same hash value across</span>
<span class="sd">    interpreter reboots) and it does not use hash customizations on user</span>
<span class="sd">    classes (it uses `pickle` internally to get a byte stream).</span>

<span class="sd">    Arguments:</span>
<span class="sd">        hash_algorithm: object implementing the `hash algorithm` interface</span>
<span class="sd">            from :mod:`hashlib` or canonical name (`str`) of the</span>
<span class="sd">            hash algorithm as defined in :mod:`hashlib`.</span>
<span class="sd">            Defaults to :class:`xxhash.xxh64`.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">hash_algorithm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">hash_algorithm</span> <span class="o">=</span> <span class="n">xxhash</span><span class="o">.</span><span class="n">xxh64</span><span class="p">()</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">hash_algorithm</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">hash_algorithm</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">hash_algorithm</span><span class="p">)</span>  <span class="c1"># type: ignore[assignment]</span>

    <span class="n">hash_algorithm</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">args</span><span class="p">))</span>  <span class="c1"># type: ignore[union-attr]</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">hash_algorithm</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>  <span class="c1"># type: ignore[union-attr]</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">result</span></div>


<span class="n">ddiff</span> <span class="o">=</span> <span class="n">deepdiff</span><span class="o">.</span><span class="n">DeepDiff</span>
<span class="sd">&quot;&quot;&quot;Shortcut for deepdiff.DeepDiff.</span>

<span class="sd">Check https://zepworks.com/deepdiff/current/diff.html for more info.</span>
<span class="sd">&quot;&quot;&quot;</span>


<div class="viewcode-block" id="dhash"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.dhash">[docs]</a><span class="k">def</span> <span class="nf">dhash</span><span class="p">(</span><span class="n">obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Shortcut for deepdiff.deephash.DeepHash.</span>

<span class="sd">    Check https://zepworks.com/deepdiff/current/deephash.html for more info.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">deepdiff</span><span class="o">.</span><span class="n">deephash</span><span class="o">.</span><span class="n">DeepHash</span><span class="p">(</span><span class="n">obj</span><span class="p">)[</span><span class="n">obj</span><span class="p">]</span></div>


<div class="viewcode-block" id="pprint_ddiff"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.pprint_ddiff">[docs]</a><span class="k">def</span> <span class="nf">pprint_ddiff</span><span class="p">(</span>
    <span class="n">old</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="n">new</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">pprint_opts</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Pretty printing of deepdiff.DeepDiff objects.</span>

<span class="sd">    Keyword Arguments:</span>
<span class="sd">        pprint_opts: kwargs dict with options for pprint.pprint.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pprint_opts</span> <span class="o">=</span> <span class="n">pprint_opts</span> <span class="ow">or</span> <span class="p">{</span><span class="s2">&quot;indent&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
    <span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">deepdiff</span><span class="o">.</span><span class="n">DeepDiff</span><span class="p">(</span><span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="o">**</span><span class="n">pprint_opts</span><span class="p">)</span></div>


<span class="n">AnyWordsIterable</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>


<div class="viewcode-block" id="CaseStyleConverter"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.CaseStyleConverter">[docs]</a><span class="k">class</span> <span class="nc">CaseStyleConverter</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Utility class to convert name strings to different case styles.</span>

<span class="sd">    Functionality exposed through :meth:`split()`, :meth:`join()` and</span>
<span class="sd">    :meth:`convert()` methods.</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="CaseStyleConverter.CASE_STYLE"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.CaseStyleConverter.CASE_STYLE">[docs]</a>    <span class="k">class</span> <span class="nc">CASE_STYLE</span><span class="p">(</span><span class="n">enum</span><span class="o">.</span><span class="n">Enum</span><span class="p">):</span>
        <span class="n">CONCATENATED</span> <span class="o">=</span> <span class="s2">&quot;concatenated&quot;</span>
        <span class="n">CANONICAL</span> <span class="o">=</span> <span class="s2">&quot;canonical&quot;</span>
        <span class="n">CAMEL</span> <span class="o">=</span> <span class="s2">&quot;camel&quot;</span>
        <span class="n">PASCAL</span> <span class="o">=</span> <span class="s2">&quot;pascal&quot;</span>
        <span class="n">SNAKE</span> <span class="o">=</span> <span class="s2">&quot;snake&quot;</span>
        <span class="n">KEBAB</span> <span class="o">=</span> <span class="s2">&quot;kebab&quot;</span></div>

<div class="viewcode-block" id="CaseStyleConverter.split"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.CaseStyleConverter.split">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">split</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">case_style</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">CASE_STYLE</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">case_style</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">case_style</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CASE_STYLE</span><span class="p">(</span><span class="n">case_style</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">case_style</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CASE_STYLE</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">case_style</span> <span class="o">==</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CASE_STYLE</span><span class="o">.</span><span class="n">CONCATENATED</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Impossible to split a simply concatenated string&quot;</span><span class="p">)</span>

        <span class="n">splitter</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;split_</span><span class="si">{</span><span class="n">case_style</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">_case&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">splitter</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="CaseStyleConverter.join"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.CaseStyleConverter.join">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">join</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">words</span><span class="p">:</span> <span class="n">AnyWordsIterable</span><span class="p">,</span> <span class="n">case_style</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">CASE_STYLE</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">case_style</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">case_style</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CASE_STYLE</span><span class="p">(</span><span class="n">case_style</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">case_style</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CASE_STYLE</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="n">words</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Iterable</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">words</span><span class="si">}</span><span class="s2">&#39; type is not a valid sequence of words&quot;</span><span class="p">)</span>

        <span class="n">joiner</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">AnyWordsIterable</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;join_</span><span class="si">{</span><span class="n">case_style</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">_case&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">joiner</span><span class="p">(</span><span class="n">words</span><span class="p">)</span></div>

<div class="viewcode-block" id="CaseStyleConverter.convert"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.CaseStyleConverter.convert">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">source_style</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">CASE_STYLE</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">target_style</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">CASE_STYLE</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">source_style</span><span class="p">),</span> <span class="n">target_style</span><span class="p">)</span></div>

    <span class="c1"># Following `join_...`` functions are based on:</span>
    <span class="c1">#    https://blog.kangz.net/posts/2016/08/31/code-generation-the-easier-way/</span>
    <span class="c1">#</span>
<div class="viewcode-block" id="CaseStyleConverter.join_concatenated_case"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.CaseStyleConverter.join_concatenated_case">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">join_concatenated_case</span><span class="p">(</span><span class="n">words</span><span class="p">:</span> <span class="n">AnyWordsIterable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="n">words</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">words</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">words</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span></div>

<div class="viewcode-block" id="CaseStyleConverter.join_canonical_case"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.CaseStyleConverter.join_canonical_case">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">join_canonical_case</span><span class="p">(</span><span class="n">words</span><span class="p">:</span> <span class="n">AnyWordsIterable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="n">words</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">words</span>
        <span class="k">return</span> <span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">words</span><span class="p">))</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span></div>

<div class="viewcode-block" id="CaseStyleConverter.join_camel_case"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.CaseStyleConverter.join_camel_case">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">join_camel_case</span><span class="p">(</span><span class="n">words</span><span class="p">:</span> <span class="n">AnyWordsIterable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="n">words</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="nb">list</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">title</span><span class="p">()</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span></div>

<div class="viewcode-block" id="CaseStyleConverter.join_pascal_case"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.CaseStyleConverter.join_pascal_case">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">join_pascal_case</span><span class="p">(</span><span class="n">words</span><span class="p">:</span> <span class="n">AnyWordsIterable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="n">words</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">words</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">title</span><span class="p">()</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">)</span></div>

<div class="viewcode-block" id="CaseStyleConverter.join_snake_case"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.CaseStyleConverter.join_snake_case">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">join_snake_case</span><span class="p">(</span><span class="n">words</span><span class="p">:</span> <span class="n">AnyWordsIterable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="n">words</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">words</span>
        <span class="k">return</span> <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">words</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span></div>

<div class="viewcode-block" id="CaseStyleConverter.join_kebab_case"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.CaseStyleConverter.join_kebab_case">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">join_kebab_case</span><span class="p">(</span><span class="n">words</span><span class="p">:</span> <span class="n">AnyWordsIterable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="n">words</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">words</span>
        <span class="k">return</span> <span class="s2">&quot;-&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">words</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span></div>

    <span class="c1"># Following `split_...`` functions are based on:</span>
    <span class="c1">#    https://stackoverflow.com/a/29920015/7232525</span>
    <span class="c1">#</span>
<div class="viewcode-block" id="CaseStyleConverter.split_canonical_case"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.CaseStyleConverter.split_canonical_case">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">split_canonical_case</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">()</span></div>

<div class="viewcode-block" id="CaseStyleConverter.split_camel_case"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.CaseStyleConverter.split_camel_case">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">split_camel_case</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="n">matches</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="s2">&quot;.+?(?:(?&lt;=[a-z])(?=[A-Z])|(?&lt;=[A-Z])(?=[A-Z][a-z])|$)&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">]</span></div>

    <span class="n">split_pascal_case</span> <span class="o">=</span> <span class="n">split_camel_case</span>

<div class="viewcode-block" id="CaseStyleConverter.split_snake_case"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.CaseStyleConverter.split_snake_case">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">split_snake_case</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="CaseStyleConverter.split_kebab_case"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.CaseStyleConverter.split_kebab_case">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">split_kebab_case</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Namespace"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.Namespace">[docs]</a><span class="k">class</span> <span class="nc">Namespace</span><span class="p">(</span><span class="n">types</span><span class="o">.</span><span class="n">SimpleNamespace</span><span class="p">,</span> <span class="n">Generic</span><span class="p">[</span><span class="n">T</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;A `types.SimpleNamespace`-like class with additional dict-like interface.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; ns = Namespace(a=10, b=&quot;hello&quot;)</span>
<span class="sd">        &gt;&gt;&gt; ns.a</span>
<span class="sd">        10</span>
<span class="sd">        &gt;&gt;&gt; ns.b = 20</span>
<span class="sd">        &gt;&gt;&gt; ns.b</span>
<span class="sd">        20</span>

<span class="sd">        &gt;&gt;&gt; ns = Namespace(a=10, b=&quot;hello&quot;)</span>
<span class="sd">        &gt;&gt;&gt; list(ns.keys())</span>
<span class="sd">        [&#39;a&#39;, &#39;b&#39;]</span>

<span class="sd">        &gt;&gt;&gt; list(ns.values())</span>
<span class="sd">        [10, &#39;hello&#39;]</span>

<span class="sd">        &gt;&gt;&gt; list(ns.items())</span>
<span class="sd">        [(&#39;a&#39;, 10), (&#39;b&#39;, &#39;hello&#39;)]</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span>

<div class="viewcode-block" id="Namespace.items"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.Namespace.items">[docs]</a>    <span class="k">def</span> <span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">T</span><span class="p">]]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()</span></div>

<div class="viewcode-block" id="Namespace.keys"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.Namespace.keys">[docs]</a>    <span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span></div>

<div class="viewcode-block" id="Namespace.values"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.Namespace.values">[docs]</a>    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">values</span><span class="p">()</span></div>

<div class="viewcode-block" id="Namespace.reset"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.Namespace.reset">[docs]</a>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></div>

<div class="viewcode-block" id="Namespace.as_dict"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.Namespace.as_dict">[docs]</a>    <span class="k">def</span> <span class="nf">as_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">T</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">{</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">}</span></div>

    <span class="n">asdict</span> <span class="o">=</span> <span class="n">as_dict</span></div>


<div class="viewcode-block" id="FrozenNamespace"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.FrozenNamespace">[docs]</a><span class="k">class</span> <span class="nc">FrozenNamespace</span><span class="p">(</span><span class="n">Namespace</span><span class="p">[</span><span class="n">T</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;An immutable version of :class:`Namespace`.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; ns = FrozenNamespace(a=10, b=&quot;hello&quot;)</span>
<span class="sd">        &gt;&gt;&gt; ns.a</span>
<span class="sd">        10</span>
<span class="sd">        &gt;&gt;&gt; ns.a = 20</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">           ...</span>
<span class="sd">        TypeError: Trying to modify immutable &#39;FrozenNamespace&#39; instance.</span>

<span class="sd">        &gt;&gt;&gt; ns = FrozenNamespace(a=10, b=&quot;hello&quot;)</span>
<span class="sd">        &gt;&gt;&gt; list(ns.items())</span>
<span class="sd">        [(&#39;a&#39;, 10), (&#39;b&#39;, &#39;hello&#39;)]</span>

<span class="sd">        &gt;&gt;&gt; ns = FrozenNamespace(a=10, b=&quot;hello&quot;)</span>
<span class="sd">        &gt;&gt;&gt; hashed = hash(ns)</span>
<span class="sd">        &gt;&gt;&gt; assert isinstance(hashed, int)</span>
<span class="sd">        &gt;&gt;&gt; hashed == hash(ns) == ns.__cached_hash_value__</span>
<span class="sd">        True</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="s2">&quot;__cached_hash_value__&quot;</span>  <span class="c1"># This slot is used to avoid polluting the namespace</span>

    <span class="k">def</span> <span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">__name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">__value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Trying to modify immutable &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; instance.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__delattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">__name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Trying to modify immutable &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; instance.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>  <span class="c1"># type: ignore[override]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;__cached_hash_value__&quot;</span><span class="p">):</span>
            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;__cached_hash_value__&quot;</span><span class="p">,</span> <span class="nb">hash</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">())))</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cached_hash_value__</span></div>


<div class="viewcode-block" id="UIDGenerator"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.UIDGenerator">[docs]</a><span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span>
<span class="k">class</span> <span class="nc">UIDGenerator</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Simple unique id generator using different methods.&quot;&quot;&quot;</span>

    <span class="n">prefix</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">dataclasses</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># type: ignore[call-overload]</span>
        <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="k">else</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">width</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">dataclasses</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># type: ignore[call-overload]</span>
        <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="k">else</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">warn_unsafe</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">dataclasses</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># type: ignore[call-overload]</span>
        <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="k">else</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="n">_counter</span><span class="p">:</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">field</span><span class="p">(</span>
        <span class="n">default_factory</span><span class="o">=</span><span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">count</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">init</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;Constantly increasing counter for generation of sequential unique ids.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="UIDGenerator.random_id"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.UIDGenerator.random_id">[docs]</a>    <span class="k">def</span> <span class="nf">random_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">prefix</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">width</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Generate a random globally unique id.&quot;&quot;&quot;</span>
        <span class="n">width</span> <span class="o">=</span> <span class="n">width</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="ow">or</span> <span class="mi">8</span>
        <span class="k">if</span> <span class="n">width</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Width must be a positive number &gt; 4 (</span><span class="si">{</span><span class="n">width</span><span class="si">}</span><span class="s2"> provided).&quot;</span><span class="p">)</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="n">prefix</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">prefix</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span>
        <span class="n">s</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)[:</span><span class="n">width</span><span class="p">]</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">prefix</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2">&quot;</span></div>

<div class="viewcode-block" id="UIDGenerator.sequential_id"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.UIDGenerator.sequential_id">[docs]</a>    <span class="k">def</span> <span class="nf">sequential_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">prefix</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">width</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Generate a sequential unique id (for the current session).&quot;&quot;&quot;</span>
        <span class="n">width</span> <span class="o">=</span> <span class="n">width</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span>
        <span class="k">if</span> <span class="n">width</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">width</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Width must be a positive number (</span><span class="si">{</span><span class="n">width</span><span class="si">}</span><span class="s2"> provided).&quot;</span><span class="p">)</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="n">prefix</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">prefix</span>
        <span class="n">count</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_counter</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">count</span><span class="si">:</span><span class="s2">0</span><span class="si">{</span><span class="n">width</span><span class="si">}}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">width</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">prefix</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2">&quot;</span></div>

<div class="viewcode-block" id="UIDGenerator.reset_sequence"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.UIDGenerator.reset_sequence">[docs]</a>    <span class="k">def</span> <span class="nf">reset_sequence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">warn_unsafe</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">UIDGenerator</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Reset generator counter.</span>

<span class="sd">        It returns the same instance to allow resetting at initialization:</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; generator = UIDGenerator().reset_sequence(3)</span>

<span class="sd">        Notes:</span>
<span class="sd">            If the new start value is lower than the last generated UID, new</span>
<span class="sd">            IDs are not longer guaranteed to be unique.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">start</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting value must be a positive number (</span><span class="si">{</span><span class="n">start</span><span class="si">}</span><span class="s2"> provided).&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">warn_unsafe</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">warn_unsafe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">warn_unsafe</span>
        <span class="k">if</span> <span class="n">warn_unsafe</span> <span class="ow">and</span> <span class="n">start</span> <span class="o">&lt;</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_counter</span><span class="p">):</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Unsafe reset of UIDGenerator (</span><span class="si">{self}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_counter</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span></div></div>


<span class="n">UIDs</span> <span class="o">=</span> <span class="n">UIDGenerator</span><span class="p">()</span>

<span class="c1"># -- Iterators --</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;S&quot;</span><span class="p">)</span>
<span class="n">K</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;K&quot;</span><span class="p">)</span>

<span class="n">P</span> <span class="o">=</span> <span class="n">ParamSpec</span><span class="p">(</span><span class="s2">&quot;P&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="as_xiter"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.as_xiter">[docs]</a><span class="k">def</span> <span class="nf">as_xiter</span><span class="p">(</span><span class="n">iterator_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="n">P</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">T</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[</span><span class="n">P</span><span class="p">,</span> <span class="n">XIterable</span><span class="p">[</span><span class="n">T</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;Wrap the provided callable to convert its output in a :class:`XIterable`.&quot;&quot;&quot;</span>

    <span class="nd">@functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">iterator_func</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_xiterator</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">keywords</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XIterable</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">xiter</span><span class="p">(</span><span class="n">iterator_func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">keywords</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">_xiterator</span></div>


<span class="n">xenumerate</span> <span class="o">=</span> <span class="n">as_xiter</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">)</span>


<div class="viewcode-block" id="XIterable"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.XIterable">[docs]</a><span class="k">class</span> <span class="nc">XIterable</span><span class="p">(</span><span class="n">Iterable</span><span class="p">[</span><span class="n">T</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Iterable wrapper supporting method chaining for extra functionality.&quot;&quot;&quot;</span>

    <span class="n">iterator</span><span class="p">:</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">T</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">it</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">T</span><span class="p">],</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">T</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;iterator&quot;</span><span class="p">,</span> <span class="nb">iter</span><span class="p">(</span><span class="n">it</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="c1"># Forward special methods to wrapped iterator</span>
        <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;__&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;__&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iterator</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; object has no attribute &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is immutable.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterator</span>

<div class="viewcode-block" id="XIterable.map"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.XIterable.map">[docs]</a>    <span class="k">def</span> <span class="nf">map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XIterable</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>  <span class="c1"># noqa  # A003: shadowing a python builtin</span>
        <span class="sd">&quot;&quot;&quot;Apply a callable to every iterator element.</span>

<span class="sd">        Equivalent to ``map(func, self)``.</span>

<span class="sd">        For detailed information check :func:`map` reference.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; it = xiter(range(3))</span>
<span class="sd">            &gt;&gt;&gt; list(it.map(str))</span>
<span class="sd">            [&#39;0&#39;, &#39;1&#39;, &#39;2&#39;]</span>

<span class="sd">            &gt;&gt;&gt; it = xiter(range(3))</span>
<span class="sd">            &gt;&gt;&gt; list(it.map(lambda x: -x).map(str))</span>
<span class="sd">            [&#39;0&#39;, &#39;-1&#39;, &#39;-2&#39;]</span>

<span class="sd">            If the callable requires additional arguments, ``lambda`` of :func:`functools.partial`</span>
<span class="sd">            functions can be used:</span>

<span class="sd">            &gt;&gt;&gt; def times(a, b):</span>
<span class="sd">            ...     return a * b</span>
<span class="sd">            &gt;&gt;&gt; times_2 = functools.partial(times, 2)</span>
<span class="sd">            &gt;&gt;&gt; it = xiter(range(4))</span>
<span class="sd">            &gt;&gt;&gt; list(it.map(lambda x: x + 1).map(times_2))</span>
<span class="sd">            [2, 4, 6, 8]</span>

<span class="sd">            Curried functions generated by :func:`toolz.curry` will also work as expected:</span>

<span class="sd">            &gt;&gt;&gt; @toolz.curry</span>
<span class="sd">            ... def mul(x, y):</span>
<span class="sd">            ...     return x * y</span>
<span class="sd">            &gt;&gt;&gt; it = xiter(range(4))</span>
<span class="sd">            &gt;&gt;&gt; list(it.map(lambda x: x + 1).map(mul(5)))</span>
<span class="sd">            [5, 10, 15, 20]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">callable</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid function or callable: &#39;</span><span class="si">{</span><span class="n">func</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">XIterable</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterator</span><span class="p">))</span></div>

<div class="viewcode-block" id="XIterable.filter"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.XIterable.filter">[docs]</a>    <span class="k">def</span> <span class="nf">filter</span><span class="p">(</span>  <span class="c1"># noqa  # A003: shadowing a python builtin</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XIterable</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Filter elements with callables.</span>

<span class="sd">        Equivalent to ``filter(func, self)``.</span>

<span class="sd">        For detailed information check :func:`filter` reference.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; it = xiter(range(4))</span>
<span class="sd">            &gt;&gt;&gt; list(it.filter(lambda x: x % 2 == 0))</span>
<span class="sd">            [0, 2]</span>

<span class="sd">            &gt;&gt;&gt; it = xiter(range(4))</span>
<span class="sd">            &gt;&gt;&gt; list(it.filter(lambda x: x % 2 == 0).filter(lambda x: x &gt; 1))</span>
<span class="sd">            [2]</span>


<span class="sd">        Notes:</span>
<span class="sd">            `lambdas`, `partial` and `curried` functions are supported (see :meth:`map`).</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">callable</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid function or callable: &#39;</span><span class="si">{</span><span class="n">func</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">XIterable</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterator</span><span class="p">))</span></div>

<div class="viewcode-block" id="XIterable.if_isinstance"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.XIterable.if_isinstance">[docs]</a>    <span class="k">def</span> <span class="nf">if_isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">types</span><span class="p">:</span> <span class="n">Type</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XIterable</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Filter elements using :func:`isinstance` checks.</span>

<span class="sd">        Equivalent to ``xiter(item for item in self if isinstance(item, types))``.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; it = xiter([1, &#39;2&#39;, 3.3, [4, 5], {6, 7}])</span>
<span class="sd">            &gt;&gt;&gt; list(it.if_isinstance(int, float))</span>
<span class="sd">            [1, 3.3]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">XIterable</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="n">isinstancechecker</span><span class="p">([</span><span class="o">*</span><span class="n">types</span><span class="p">]),</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterator</span><span class="p">))</span></div>

<div class="viewcode-block" id="XIterable.if_not_isinstance"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.XIterable.if_not_isinstance">[docs]</a>    <span class="k">def</span> <span class="nf">if_not_isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">types</span><span class="p">:</span> <span class="n">Type</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XIterable</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Filter elements using negated :func:`isinstance` checks.</span>

<span class="sd">        Equivalent to ``xiter(item for item in self if not isinstance(item, types))``.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; it = xiter([1, &#39;2&#39;, 3.3, [4, 5], {6, 7}])</span>
<span class="sd">            &gt;&gt;&gt; list(it.if_not_isinstance(int, float))</span>
<span class="sd">            [&#39;2&#39;, [4, 5], {6, 7}]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">XIterable</span><span class="p">(</span>
            <span class="nb">filter</span><span class="p">(</span><span class="n">toolz</span><span class="o">.</span><span class="n">functoolz</span><span class="o">.</span><span class="n">complement</span><span class="p">(</span><span class="n">isinstancechecker</span><span class="p">([</span><span class="o">*</span><span class="n">types</span><span class="p">])),</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterator</span><span class="p">)</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="XIterable.if_is"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.XIterable.if_is">[docs]</a>    <span class="k">def</span> <span class="nf">if_is</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XIterable</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Filter elements using :func:`operator.is_` checks.</span>

<span class="sd">        Equivalent to ``xiter(item for item in self if item is obj)``.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; it = xiter([1, None, 1, 123456789, None, 123456789])</span>
<span class="sd">            &gt;&gt;&gt; list(it.if_is(None))</span>
<span class="sd">            [None, None]</span>

<span class="sd">            &gt;&gt;&gt; it = xiter([1, None, 1, 123456789, None, 123456789])</span>
<span class="sd">            &gt;&gt;&gt; list(it.if_is(1))</span>
<span class="sd">            [1, 1]</span>

<span class="sd">            &gt;&gt;&gt; it = xiter([1, None, 1, 123456789, None, 123456789])</span>
<span class="sd">            &gt;&gt;&gt; list(it.if_is(123456789))</span>
<span class="sd">            []</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">XIterable</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">operator</span><span class="o">.</span><span class="n">is_</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">obj</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterator</span><span class="p">))</span></div>

<div class="viewcode-block" id="XIterable.if_is_not"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.XIterable.if_is_not">[docs]</a>    <span class="k">def</span> <span class="nf">if_is_not</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XIterable</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Filter elements using negated  :func:`operator.is_` checks.</span>

<span class="sd">        Equivalent to ``xiter(item for item in self if item is not obj)``.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; it = xiter([1, None, 1, 123456789, None, 123456789])</span>
<span class="sd">            &gt;&gt;&gt; list(it.if_is_not(None))</span>
<span class="sd">            [1, 1, 123456789, 123456789]</span>

<span class="sd">            &gt;&gt;&gt; it = xiter([1, None, 1, 123456789, None, 123456789])</span>
<span class="sd">            &gt;&gt;&gt; list(it.if_is_not(1))</span>
<span class="sd">            [None, 123456789, None, 123456789]</span>

<span class="sd">            &gt;&gt;&gt; it = xiter([1, None, 1, 123456789, None, 123456789])</span>
<span class="sd">            &gt;&gt;&gt; list(it.if_is_not(123456789))</span>
<span class="sd">            [1, None, 1, 123456789, None, 123456789]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">XIterable</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="ow">not</span> <span class="n">operator</span><span class="o">.</span><span class="n">is_</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">obj</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterator</span><span class="p">))</span></div>

<div class="viewcode-block" id="XIterable.if_in"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.XIterable.if_in">[docs]</a>    <span class="k">def</span> <span class="nf">if_in</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">collection</span><span class="p">:</span> <span class="n">Collection</span><span class="p">[</span><span class="n">T</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">XIterable</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Filter elements using :func:`operator.contains` checks.</span>

<span class="sd">        Equivalent to ``xiter(item for item in self if item in collection)``.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; it = xiter(range(8))</span>
<span class="sd">            &gt;&gt;&gt; list(it.if_in([0, 2, 4, 6]))</span>
<span class="sd">            [0, 2, 4, 6]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">XIterable</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">operator</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterator</span><span class="p">))</span></div>

<div class="viewcode-block" id="XIterable.if_not_in"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.XIterable.if_not_in">[docs]</a>    <span class="k">def</span> <span class="nf">if_not_in</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">collection</span><span class="p">:</span> <span class="n">Collection</span><span class="p">[</span><span class="n">T</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">XIterable</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Filter elements using negated :func:`operator.contains` checks.</span>

<span class="sd">        Equivalent to ``xiter(item for item in self if item not in collection)``.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; it = xiter(range(8))</span>
<span class="sd">            &gt;&gt;&gt; list(it.if_not_in([0, 2, 4, 6]))</span>
<span class="sd">            [1, 3, 5, 7]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">XIterable</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="ow">not</span> <span class="n">operator</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterator</span><span class="p">))</span></div>

<div class="viewcode-block" id="XIterable.if_contains"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.XIterable.if_contains">[docs]</a>    <span class="k">def</span> <span class="nf">if_contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">values</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XIterable</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Filter elements using :func:`operator.contains` checks.</span>

<span class="sd">        Equivalent to ``xiter(item for item in self if all(v in item for v in values))``.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; it = xiter([None, (0, 1, 2), &quot;a&quot;, (1, 2, 3), (2, 3, 4), &quot;b&quot;])</span>
<span class="sd">            &gt;&gt;&gt; list(it.if_contains(2))</span>
<span class="sd">            [(0, 1, 2), (1, 2, 3), (2, 3, 4)]</span>

<span class="sd">            &gt;&gt;&gt; it = xiter([None, (0, 1, 2), &quot;a&quot;, (1, 2, 3), (2, 3, 4), &quot;b&quot;])</span>
<span class="sd">            &gt;&gt;&gt; list(it.if_contains(1, 2))</span>
<span class="sd">            [(0, 1, 2), (1, 2, 3)]</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">_contains</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">collection</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">collection</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="n">XIterable</span><span class="p">(</span><span class="nb">filter</span><span class="p">((</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_contains</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">values</span><span class="p">)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterator</span><span class="p">))</span></div>

<div class="viewcode-block" id="XIterable.if_hasattr"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.XIterable.if_hasattr">[docs]</a>    <span class="k">def</span> <span class="nf">if_hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">names</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XIterable</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Filter elements using :func:`hasattr` checks.</span>

<span class="sd">        Equivalent to ``filter(attrchecker(names), self)``.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; it = xiter([1, &#39;2&#39;, 3.3, [4, 5], {6, 7}])</span>
<span class="sd">            &gt;&gt;&gt; list(it.if_hasattr(&#39;__len__&#39;))</span>
<span class="sd">            [&#39;2&#39;, [4, 5], {6, 7}]</span>

<span class="sd">            &gt;&gt;&gt; it = xiter([1, &#39;2&#39;, 3.3, [4, 5], {6, 7}])</span>
<span class="sd">            &gt;&gt;&gt; list(it.if_hasattr(&#39;__len__&#39;, &#39;index&#39;))</span>
<span class="sd">            [&#39;2&#39;, [4, 5]]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">XIterable</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="n">attrchecker</span><span class="p">(</span><span class="o">*</span><span class="n">names</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterator</span><span class="p">))</span></div>

<div class="viewcode-block" id="XIterable.getattr"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.XIterable.getattr">[docs]</a>    <span class="k">def</span> <span class="nf">getattr</span><span class="p">(</span>  <span class="c1"># noqa  # A003: shadowing a python builtin</span>
        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">names</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">NOTHING</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XIterable</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get provided attributes from each item in a sequence.</span>

<span class="sd">        Equivalent to ``map(attrgetter_(*names, default=default), self)``.</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            default: returned value if the item does not contain an attribute</span>
<span class="sd">                with the provided `name`.</span>

<span class="sd">        For detailed information check :func:`attrgetter_` and :func:`operator.attrgetter` reference.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from collections import namedtuple</span>
<span class="sd">            &gt;&gt;&gt; Point = namedtuple(&#39;Point&#39;, [&#39;x&#39;, &#39;y&#39;])</span>
<span class="sd">            &gt;&gt;&gt; it = xiter([Point(1.0, -1.0), Point(2.0, -2.0), Point(3.0, -3.0)])</span>
<span class="sd">            &gt;&gt;&gt; list(it.getattr(&#39;y&#39;))</span>
<span class="sd">            [-1.0, -2.0, -3.0]</span>

<span class="sd">            &gt;&gt;&gt; it = xiter([Point(1.0, -1.0), Point(2.0, -2.0), Point(3.0, -3.0)])</span>
<span class="sd">            &gt;&gt;&gt; list(it.getattr(&#39;x&#39;, &#39;z&#39;, default=None))</span>
<span class="sd">            [(1.0, None), (2.0, None), (3.0, None)]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">XIterable</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">attrgetter_</span><span class="p">(</span><span class="o">*</span><span class="n">names</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterator</span><span class="p">))</span></div>

<div class="viewcode-block" id="XIterable.getitem"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.XIterable.getitem">[docs]</a>    <span class="k">def</span> <span class="nf">getitem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">indices</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">default</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">NOTHING</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XIterable</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get provided indices data from each item in a sequence.</span>

<span class="sd">        Equivalent to ``toolz.itertoolz.pluck(indices, self)``.</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            default: returned value if the item does not contain an `index`</span>
<span class="sd">                with the provided value.</span>

<span class="sd">        For detailed information check :func:`toolz.itertoolz.pluck` reference.</span>

<span class="sd">            &gt;&gt;&gt; it = xiter([(&#39;a&#39;, 1), (&#39;b&#39;, 2), (&#39;c&#39;, 3)])</span>
<span class="sd">            &gt;&gt;&gt; list(it.getitem(0))</span>
<span class="sd">            [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]</span>

<span class="sd">            &gt;&gt;&gt; it = xiter([</span>
<span class="sd">            ...     dict(name=&quot;AA&quot;, age=20, country=&quot;US&quot;),</span>
<span class="sd">            ...     dict(name=&quot;BB&quot;, age=30, country=&quot;UK&quot;),</span>
<span class="sd">            ...     dict(name=&quot;CC&quot;, age=40, country=&quot;EU&quot;),</span>
<span class="sd">            ...     dict(country=&quot;CH&quot;)</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; list(it.getitem(&quot;name&quot;, &quot;age&quot;, default=None))</span>
<span class="sd">            [(&#39;AA&#39;, 20), (&#39;BB&#39;, 30), (&#39;CC&#39;, 40), (None, None)]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ind</span><span class="p">:</span> <span class="n">Any</span>  <span class="c1"># a hashable item or a list of hashable items</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="n">indices</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">default</span> <span class="ow">is</span> <span class="n">NOTHING</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">XIterable</span><span class="p">(</span><span class="n">toolz</span><span class="o">.</span><span class="n">itertoolz</span><span class="o">.</span><span class="n">pluck</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterator</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">XIterable</span><span class="p">(</span><span class="n">toolz</span><span class="o">.</span><span class="n">itertoolz</span><span class="o">.</span><span class="n">pluck</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterator</span><span class="p">,</span> <span class="n">default</span><span class="p">))</span></div>

<div class="viewcode-block" id="XIterable.chain"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.XIterable.chain">[docs]</a>    <span class="k">def</span> <span class="nf">chain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">others</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XIterable</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">T</span><span class="p">,</span> <span class="n">S</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Chain iterators.</span>

<span class="sd">        Equivalent to ``itertools.chain(self, *others)``.</span>

<span class="sd">        For detailed information check :func:`itertools.chain` reference.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; it_a, it_b = xiter(range(2)), xiter([&#39;a&#39;, &#39;b&#39;])</span>
<span class="sd">            &gt;&gt;&gt; list(it_a.chain(it_b))</span>
<span class="sd">            [0, 1, &#39;a&#39;, &#39;b&#39;]</span>

<span class="sd">            &gt;&gt;&gt; it_a = xiter(range(2))</span>
<span class="sd">            &gt;&gt;&gt; list(it_a.chain([&#39;a&#39;, &#39;b&#39;], [&#39;A&#39;, &#39;B&#39;]))</span>
<span class="sd">            [0, 1, &#39;a&#39;, &#39;b&#39;, &#39;A&#39;, &#39;B&#39;]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">iterators</span> <span class="o">=</span> <span class="p">[</span><span class="n">it</span><span class="o">.</span><span class="n">iterator</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="n">XIterable</span><span class="p">)</span> <span class="k">else</span> <span class="n">it</span> <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="n">others</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">XIterable</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iterator</span><span class="p">,</span> <span class="o">*</span><span class="n">iterators</span><span class="p">))</span></div>

<div class="viewcode-block" id="XIterable.diff"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.XIterable.diff">[docs]</a>    <span class="k">def</span> <span class="nf">diff</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="n">others</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">,</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">NOTHING</span><span class="p">,</span>
        <span class="n">key</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">NOTHING</span><span class="p">,</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="n">NOTHING</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XIterable</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">T</span><span class="p">,</span> <span class="n">S</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Diff iterators.</span>

<span class="sd">        Equivalent to ``toolz.itertoolz.diff(self, *others)``.</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            default: returned value for missing items.</span>
<span class="sd">            key: callable computing the key to use per item in the sequence.</span>

<span class="sd">        For detailed information check :func:`toolz.itertoolz.diff` reference.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; it_a, it_b = xiter([1, 2, 3]), xiter([1, 3, 5])</span>
<span class="sd">            &gt;&gt;&gt; list(it_a.diff(it_b))</span>
<span class="sd">            [(2, 3), (3, 5)]</span>

<span class="sd">            &gt;&gt;&gt; it_a, it_b, it_c = xiter([1, 2, 3]), xiter([1, 3, 5]), xiter([1, 2, 5])</span>
<span class="sd">            &gt;&gt;&gt; list(it_a.diff(it_b, it_c))</span>
<span class="sd">            [(2, 3, 2), (3, 5, 5)]</span>

<span class="sd">            Adding missing values:</span>

<span class="sd">            &gt;&gt;&gt; it_a = xiter([1, 2, 3, 4])</span>
<span class="sd">            &gt;&gt;&gt; list(it_a.diff([1, 3, 5], default=None))</span>
<span class="sd">            [(2, 3), (3, 5), (4, None)]</span>

<span class="sd">            Use a key function:</span>

<span class="sd">            &gt;&gt;&gt; it_a, it_b = xiter([&quot;Apples&quot;, &quot;Bananas&quot;]), xiter([&quot;apples&quot;, &quot;oranges&quot;])</span>
<span class="sd">            &gt;&gt;&gt; list(it_a.diff(it_b, key=str.lower))</span>
<span class="sd">            [(&#39;Bananas&#39;, &#39;oranges&#39;)]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">default</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">NOTHING</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">default</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">NOTHING</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span>

        <span class="n">iterators</span> <span class="o">=</span> <span class="p">[</span><span class="n">it</span><span class="o">.</span><span class="n">iterator</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="n">XIterable</span><span class="p">)</span> <span class="k">else</span> <span class="n">it</span> <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="n">others</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">XIterable</span><span class="p">(</span><span class="n">toolz</span><span class="o">.</span><span class="n">itertoolz</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iterator</span><span class="p">,</span> <span class="o">*</span><span class="n">iterators</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span></div>

<div class="viewcode-block" id="XIterable.product"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.XIterable.product">[docs]</a>    <span class="k">def</span> <span class="nf">product</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">S</span><span class="p">],</span> <span class="nb">int</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">XIterable</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">T</span><span class="p">,</span> <span class="n">S</span><span class="p">]],</span> <span class="n">XIterable</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">T</span><span class="p">,</span> <span class="n">T</span><span class="p">]]]:</span>
        <span class="sd">&quot;&quot;&quot;Product of iterators.</span>

<span class="sd">        Equivalent to ``itertools.product(it_a, it_b)``.</span>

<span class="sd">        For detailed information check :func:`itertools.product` reference.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; it_a, it_b = xiter([0, 1]), xiter([&#39;a&#39;, &#39;b&#39;])</span>
<span class="sd">            &gt;&gt;&gt; list(it_a.product(it_b))</span>
<span class="sd">            [(0, &#39;a&#39;), (0, &#39;b&#39;), (1, &#39;a&#39;), (1, &#39;b&#39;)]</span>

<span class="sd">            Product of an iterator with itself:</span>

<span class="sd">            &gt;&gt;&gt; it_a = xiter([0, 1])</span>
<span class="sd">            &gt;&gt;&gt; list(it_a.product(3))</span>
<span class="sd">            [(0, 0, 0), (1, 1, 1)]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">other</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Only non-negative integer numbers are accepted (provided: </span><span class="si">{</span><span class="n">other</span><span class="si">}</span><span class="s2">).&quot;</span>
                <span class="p">)</span>
            <span class="k">return</span> <span class="n">XIterable</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">item</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">([</span><span class="n">item</span><span class="p">]</span> <span class="o">*</span> <span class="n">other</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterator</span><span class="p">))</span>  <span class="c1"># type: ignore  # mypy gets confused with `other`</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">XIterable</span><span class="p">):</span>
                <span class="n">other</span> <span class="o">=</span> <span class="n">xiter</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">XIterable</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iterator</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">iterator</span><span class="p">))</span></div>

<div class="viewcode-block" id="XIterable.partition"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.XIterable.partition">[docs]</a>    <span class="k">def</span> <span class="nf">partition</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">exact</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">fill</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">NOTHING</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XIterable</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">T</span><span class="p">,</span> <span class="o">...</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Partition iterator into tuples of length `n` (``exact=True``) or at most `n` (``exact=False``).</span>

<span class="sd">        Equivalent to ``toolz.itertoolz.partition(n, self)`` or</span>
<span class="sd">        ``toolz.itertoolz.partition_all(n, self)``.</span>

<span class="sd">        For detailed information check :func:`toolz.itertoolz.partition` and</span>
<span class="sd">        :func:`toolz.itertoolz.partition_all` reference.</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            exact: if `True`, it will return tuples of length `n`. If `False`, the last</span>
<span class="sd">                tuple could have a smaller size if there are not enough items in the sequence.</span>
<span class="sd">            fill: if provided together with ``exact=True``, this value will be used to fill</span>
<span class="sd">                the last tuple until it has exactly length `n`.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; it = xiter(range(7))</span>
<span class="sd">            &gt;&gt;&gt; list(it.partition(3))</span>
<span class="sd">            [(0, 1, 2), (3, 4, 5), (6,)]</span>

<span class="sd">            &gt;&gt;&gt; it = xiter(range(7))</span>
<span class="sd">            &gt;&gt;&gt; list(it.partition(3, exact=True))</span>
<span class="sd">            [(0, 1, 2), (3, 4, 5)]</span>

<span class="sd">            &gt;&gt;&gt; it = xiter(range(7))</span>
<span class="sd">            &gt;&gt;&gt; list(it.partition(3, exact=True, fill=None))</span>
<span class="sd">            [(0, 1, 2), (3, 4, 5), (6, None, None)]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Only positive integer numbers are accepted (provided: </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">).&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">exact</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">fill</span> <span class="ow">is</span> <span class="n">NOTHING</span><span class="p">:</span>
                <span class="n">iterator</span> <span class="o">=</span> <span class="n">toolz</span><span class="o">.</span><span class="n">itertoolz</span><span class="o">.</span><span class="n">partition</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterator</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iterator</span> <span class="o">=</span> <span class="n">toolz</span><span class="o">.</span><span class="n">itertoolz</span><span class="o">.</span><span class="n">partition</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterator</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="n">fill</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">iterator</span> <span class="o">=</span> <span class="n">toolz</span><span class="o">.</span><span class="n">itertoolz</span><span class="o">.</span><span class="n">partition_all</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterator</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">XIterable</span><span class="p">(</span><span class="n">iterator</span><span class="p">)</span></div>

<div class="viewcode-block" id="XIterable.take_nth"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.XIterable.take_nth">[docs]</a>    <span class="k">def</span> <span class="nf">take_nth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XIterable</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Take every nth item in sequence.</span>

<span class="sd">        Equivalent to ``toolz.itertoolz.take_nth(n, self)``.</span>

<span class="sd">        For detailed information check :func:`toolz.itertoolz.take_nth` reference.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; it = xiter(range(7))</span>
<span class="sd">            &gt;&gt;&gt; list(it.take_nth(3))</span>
<span class="sd">            [0, 3, 6]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Only positive integer numbers are accepted (provided: </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">).&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">XIterable</span><span class="p">(</span><span class="n">toolz</span><span class="o">.</span><span class="n">itertoolz</span><span class="o">.</span><span class="n">take_nth</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterator</span><span class="p">))</span></div>

<div class="viewcode-block" id="XIterable.zip"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.XIterable.zip">[docs]</a>    <span class="k">def</span> <span class="nf">zip</span><span class="p">(</span>  <span class="c1"># noqa  # A003: shadowing a python builtin</span>
        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">others</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">fill</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">NOTHING</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XIterable</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">T</span><span class="p">,</span> <span class="n">S</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Zip iterators.</span>

<span class="sd">        Equivalent to ``zip(self, *others)`` or ``itertools.zip_longest(self, *others, fillvalue=fill)``.</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            fill: value used to fill the result for sequences with fewer items.</span>

<span class="sd">        For detailed information check :func:`zip` and :func:`itertools.zip_longest` reference.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; it_a = xiter(range(3))</span>
<span class="sd">            &gt;&gt;&gt; it_b = [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]</span>
<span class="sd">            &gt;&gt;&gt; list(it_a.zip(it_b))</span>
<span class="sd">            [(0, &#39;a&#39;), (1, &#39;b&#39;), (2, &#39;c&#39;)]</span>

<span class="sd">            &gt;&gt;&gt; it = xiter(range(3))</span>
<span class="sd">            &gt;&gt;&gt; list(it.zip([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], [&#39;A&#39;, &#39;B&#39;, &#39;C&#39;]))</span>
<span class="sd">            [(0, &#39;a&#39;, &#39;A&#39;), (1, &#39;b&#39;, &#39;B&#39;), (2, &#39;c&#39;, &#39;C&#39;)]</span>

<span class="sd">            &gt;&gt;&gt; it = xiter(range(5))</span>
<span class="sd">            &gt;&gt;&gt; list(it.zip([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], [&#39;A&#39;, &#39;B&#39;, &#39;C&#39;], fill=None))</span>
<span class="sd">            [(0, &#39;a&#39;, &#39;A&#39;), (1, &#39;b&#39;, &#39;B&#39;), (2, &#39;c&#39;, &#39;C&#39;), (3, None, None), (4, None, None)]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">iterators</span> <span class="o">=</span> <span class="p">[</span><span class="n">it</span><span class="o">.</span><span class="n">iterator</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="n">XIterable</span><span class="p">)</span> <span class="k">else</span> <span class="n">it</span> <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="n">others</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">fill</span> <span class="ow">is</span> <span class="n">NOTHING</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">XIterable</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iterator</span><span class="p">,</span> <span class="o">*</span><span class="n">iterators</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">XIterable</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">zip_longest</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iterator</span><span class="p">,</span> <span class="o">*</span><span class="n">iterators</span><span class="p">,</span> <span class="n">fillvalue</span><span class="o">=</span><span class="n">fill</span><span class="p">))</span></div>

<div class="viewcode-block" id="XIterable.unzip"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.XIterable.unzip">[docs]</a>    <span class="k">def</span> <span class="nf">unzip</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XIterable</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Unzip iterator.</span>

<span class="sd">        Equivalent to ``zip(*self)``.</span>

<span class="sd">        For detailed information check :func:`zip` reference.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; it = xiter([(&#39;a&#39;, 1), (&#39;b&#39;, 2), (&#39;c&#39;, 3)])</span>
<span class="sd">            &gt;&gt;&gt; list(it.unzip())</span>
<span class="sd">            [(&#39;a&#39;, &#39;b&#39;, &#39;c&#39;), (1, 2, 3)]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">XIterable</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">iterator</span><span class="p">))</span>  <span class="c1"># type: ignore  # mypy gets confused with *args</span></div>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">islice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">__stop</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XIterable</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
        <span class="o">...</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">islice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">__start</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">__stop</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">__step</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XIterable</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
        <span class="o">...</span>

<div class="viewcode-block" id="XIterable.islice"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.XIterable.islice">[docs]</a>    <span class="k">def</span> <span class="nf">islice</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">__start_or_stop</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">__stop_or_nothing</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">NothingType</span><span class="p">]</span> <span class="o">=</span> <span class="n">NOTHING</span><span class="p">,</span>
        <span class="n">step</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XIterable</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Select elements from an iterable.</span>

<span class="sd">        Equivalent to ``itertools.islice(iterator, start, stop, step)``.</span>

<span class="sd">        For detailed information check :func:`itertools.islice` reference.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; it = xiter(range(10))</span>
<span class="sd">            &gt;&gt;&gt; list(it.islice(2))</span>
<span class="sd">            [0, 1]</span>

<span class="sd">            &gt;&gt;&gt; it = xiter(range(10))</span>
<span class="sd">            &gt;&gt;&gt; list(it.islice(2, 8))</span>
<span class="sd">            [2, 3, 4, 5, 6, 7]</span>

<span class="sd">            &gt;&gt;&gt; it = xiter(range(10))</span>
<span class="sd">            &gt;&gt;&gt; list(it.islice(2, 8, 2))</span>
<span class="sd">            [2, 4, 6]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">__stop_or_nothing</span> <span class="ow">is</span> <span class="n">NOTHING</span><span class="p">:</span>
            <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">stop</span> <span class="o">=</span> <span class="n">__start_or_stop</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">__stop_or_nothing</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">__start_or_stop</span>
            <span class="n">stop</span> <span class="o">=</span> <span class="n">__stop_or_nothing</span>
        <span class="k">return</span> <span class="n">XIterable</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">islice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iterator</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span></div>

<div class="viewcode-block" id="XIterable.select"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.XIterable.select">[docs]</a>    <span class="k">def</span> <span class="nf">select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selectors</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">bool</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">XIterable</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Return only the elements which have a corresponding element in selectors that evaluates to True.</span>

<span class="sd">        Equivalent to ``itertools.compress(self, selectors)``.</span>

<span class="sd">        For detailed information check :func:`itertools.compress` reference.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; it = xiter([1, 2, 3, 1, 3])</span>
<span class="sd">            &gt;&gt;&gt; list(it.select([True, False, 1, False, 0]))</span>
<span class="sd">            [1, 3]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selectors</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Iterable</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Non-iterable &#39;selectors&#39; value: &#39;</span><span class="si">{</span><span class="n">selectors</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">XIterable</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iterator</span><span class="p">,</span> <span class="n">selectors</span><span class="p">))</span></div>

<div class="viewcode-block" id="XIterable.unique"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.XIterable.unique">[docs]</a>    <span class="k">def</span> <span class="nf">unique</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">NOTHING</span><span class="p">,</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="n">NOTHING</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XIterable</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Return only unique elements of a sequence.</span>

<span class="sd">        Equivalent to ``toolz.itertoolz.unique(self)``.</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            key: callable computing the key to use per item in the sequence.</span>

<span class="sd">        For detailed information check :func:`toolz.itertoolz.unique` reference.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; it = xiter([1, 2, 3, 1, 3])</span>
<span class="sd">            &gt;&gt;&gt; list(it.unique())</span>
<span class="sd">            [1, 2, 3]</span>

<span class="sd">            &gt;&gt;&gt; it = xiter([&#39;cat&#39;, &#39;mouse&#39;, &#39;dog&#39;, &#39;hen&#39;])</span>
<span class="sd">            &gt;&gt;&gt; list(it.unique(key=len))</span>
<span class="sd">            [&#39;cat&#39;, &#39;mouse&#39;]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="n">NOTHING</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">XIterable</span><span class="p">(</span><span class="n">toolz</span><span class="o">.</span><span class="n">itertoolz</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iterator</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">XIterable</span><span class="p">(</span><span class="n">toolz</span><span class="o">.</span><span class="n">itertoolz</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iterator</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">))</span></div>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">groupby</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">other_keys</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">as_dict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XIterable</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">T</span><span class="p">]]]:</span>
        <span class="o">...</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">groupby</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="o">*</span><span class="p">,</span> <span class="n">as_dict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XIterable</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">T</span><span class="p">]]]:</span>
        <span class="o">...</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">groupby</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">T</span><span class="p">],</span> <span class="n">Any</span><span class="p">],</span> <span class="o">*</span><span class="p">,</span> <span class="n">as_dict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XIterable</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">T</span><span class="p">]]]:</span>
        <span class="o">...</span>

<div class="viewcode-block" id="XIterable.groupby"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.XIterable.groupby">[docs]</a>    <span class="k">def</span> <span class="nf">groupby</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">key</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">T</span><span class="p">],</span> <span class="n">Any</span><span class="p">]],</span>
        <span class="o">*</span><span class="n">attr_keys</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">as_dict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">XIterable</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">T</span><span class="p">]]],</span> <span class="n">Dict</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Group a sequence by a given key.</span>

<span class="sd">        More or less equivalent to ``toolz.itertoolz.groupby(key, self)`` with some caveats.</span>

<span class="sd">        The `key` argument is used in the following way:</span>

<span class="sd">            - if `key` is a callable, it will be passed directly to :func:`toolz.itertoolz.groupby`</span>
<span class="sd">              to compute an actual `key` value for each item in the sequence.</span>
<span class="sd">            - if `key` is a ``str`` or (multiple ``str`` args) they will be used as</span>
<span class="sd">              attributes names (:func:`operator.attrgetter`).</span>
<span class="sd">            - if `key` is a ``list`` of values, they will be used as index values</span>
<span class="sd">              for :func:`operator.itemgetter`.</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            as_dict: if `True`, it will return the groups ``dict`` instead of a :class:`XIterable`</span>
<span class="sd">                instance over `groups.items()`.</span>

<span class="sd">        For detailed information check :func:`toolz.itertoolz.groupby` reference.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; it = xiter([(1.0, -1.0), (1.0,-2.0), (2.2, -3.0)])</span>
<span class="sd">            &gt;&gt;&gt; list(it.groupby([0]))</span>
<span class="sd">            [(1.0, [(1.0, -1.0), (1.0, -2.0)]), (2.2, [(2.2, -3.0)])]</span>

<span class="sd">            &gt;&gt;&gt; data = [</span>
<span class="sd">            ...     {&#39;x&#39;: 1.0, &#39;y&#39;: -1.0, &#39;z&#39;: 1.0},</span>
<span class="sd">            ...     {&#39;x&#39;: 1.0, &#39;y&#39;: -2.0, &#39;z&#39;: 1.0},</span>
<span class="sd">            ...     {&#39;x&#39;: 2.2, &#39;y&#39;: -3.0, &#39;z&#39;: 2.2}</span>
<span class="sd">            ... ]</span>
<span class="sd">            &gt;&gt;&gt; list(xiter(data).groupby([&#39;x&#39;]))</span>
<span class="sd">            [(1.0, [{&#39;x&#39;: 1.0, &#39;y&#39;: -1.0, &#39;z&#39;: 1.0}, {&#39;x&#39;: 1.0, &#39;y&#39;: -2.0, &#39;z&#39;: 1.0}]), (2.2, [{&#39;x&#39;: 2.2, &#39;y&#39;: -3.0, &#39;z&#39;: 2.2}])]</span>
<span class="sd">            &gt;&gt;&gt; list(xiter(data).groupby([&#39;x&#39;, &#39;z&#39;]))</span>
<span class="sd">            [((1.0, 1.0), [{&#39;x&#39;: 1.0, &#39;y&#39;: -1.0, &#39;z&#39;: 1.0}, {&#39;x&#39;: 1.0, &#39;y&#39;: -2.0, &#39;z&#39;: 1.0}]), ((2.2, 2.2), [{&#39;x&#39;: 2.2, &#39;y&#39;: -3.0, &#39;z&#39;: 2.2}])]</span>

<span class="sd">            &gt;&gt;&gt; from collections import namedtuple</span>
<span class="sd">            &gt;&gt;&gt; Point = namedtuple(&#39;Point&#39;, [&#39;x&#39;, &#39;y&#39;, &#39;z&#39;])</span>
<span class="sd">            &gt;&gt;&gt; data = [Point(1.0, -2.0, 1.0), Point(1.0, -2.0, 1.0), Point(2.2, 3.0, 2.0)]</span>
<span class="sd">            &gt;&gt;&gt; list(xiter(data).groupby(&#39;x&#39;))</span>
<span class="sd">            [(1.0, [Point(x=1.0, y=-2.0, z=1.0), Point(x=1.0, y=-2.0, z=1.0)]), (2.2, [Point(x=2.2, y=3.0, z=2.0)])]</span>
<span class="sd">            &gt;&gt;&gt; list(xiter(data).groupby(&#39;x&#39;, &#39;z&#39;))</span>
<span class="sd">            [((1.0, 1.0), [Point(x=1.0, y=-2.0, z=1.0), Point(x=1.0, y=-2.0, z=1.0)]), ((2.2, 2.0), [Point(x=2.2, y=3.0, z=2.0)])]</span>

<span class="sd">            &gt;&gt;&gt; it = xiter([&#39;Alice&#39;, &#39;Bob&#39;, &#39;Charlie&#39;, &#39;Dan&#39;, &#39;Edith&#39;, &#39;Frank&#39;])</span>
<span class="sd">            &gt;&gt;&gt; list(it.groupby(len))</span>
<span class="sd">            [(5, [&#39;Alice&#39;, &#39;Edith&#39;, &#39;Frank&#39;]), (3, [&#39;Bob&#39;, &#39;Dan&#39;]), (7, [&#39;Charlie&#39;])]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">callable</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">)))</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">attr_keys</span>
        <span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid &#39;key&#39; function or attribute name: &#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
            <span class="n">groupby_key</span> <span class="o">=</span> <span class="n">key</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">groupby_key</span> <span class="o">=</span> <span class="n">operator</span><span class="o">.</span><span class="n">itemgetter</span><span class="p">(</span><span class="o">*</span><span class="n">key</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
            <span class="n">groupby_key</span> <span class="o">=</span> <span class="n">operator</span><span class="o">.</span><span class="n">attrgetter</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="o">*</span><span class="n">attr_keys</span><span class="p">)</span>

        <span class="n">groups</span> <span class="o">=</span> <span class="n">toolz</span><span class="o">.</span><span class="n">itertoolz</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">groupby_key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterator</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">groups</span> <span class="k">if</span> <span class="n">as_dict</span> <span class="k">else</span> <span class="n">xiter</span><span class="p">(</span><span class="n">groups</span><span class="o">.</span><span class="n">items</span><span class="p">())</span></div>

<div class="viewcode-block" id="XIterable.accumulate"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.XIterable.accumulate">[docs]</a>    <span class="k">def</span> <span class="nf">accumulate</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">,</span> <span class="n">T</span><span class="p">],</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">operator</span><span class="o">.</span><span class="n">add</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">init</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XIterable</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Reduce an iterator using a callable.</span>

<span class="sd">        Equivalent to ``itertools.accumulate(self, func, init)``.</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            init: initial value for the accumulation.</span>

<span class="sd">        For detailed information check :func:`itertools.accumulate` reference.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; it = xiter(range(5))</span>
<span class="sd">            &gt;&gt;&gt; list(it.accumulate())</span>
<span class="sd">            [0, 1, 3, 6, 10]</span>

<span class="sd">            &gt;&gt;&gt; it = xiter(range(5))</span>
<span class="sd">            &gt;&gt;&gt; list(it.accumulate(init=10))</span>
<span class="sd">            [10, 10, 11, 13, 16, 20]</span>

<span class="sd">            &gt;&gt;&gt; it = xiter(range(1, 5))</span>
<span class="sd">            &gt;&gt;&gt; list(it.accumulate((lambda x, y: x * y), init=-1))</span>
<span class="sd">            [-1, -1, -2, -6, -24]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">XIterable</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">accumulate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iterator</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="n">init</span><span class="p">))</span></div>

<div class="viewcode-block" id="XIterable.reduce"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.XIterable.reduce">[docs]</a>    <span class="k">def</span> <span class="nf">reduce</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bin_op_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">,</span> <span class="n">T</span><span class="p">],</span> <span class="n">Any</span><span class="p">],</span> <span class="o">*</span><span class="p">,</span> <span class="n">init</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Reduce an iterator using a callable.</span>

<span class="sd">        Equivalent to ``functools.reduce(bin_op_func, self, init)``.</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            init: initial value for the reduction.</span>

<span class="sd">        For detailed information check :func:`functools.reduce` reference.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; it = xiter(range(5))</span>
<span class="sd">            &gt;&gt;&gt; it.reduce((lambda accu, i: accu + i), init=0)</span>
<span class="sd">            10</span>

<span class="sd">            &gt;&gt;&gt; it = xiter([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;])</span>
<span class="sd">            &gt;&gt;&gt; sorted(it.reduce((lambda accu, item: (accu or set()) | {item} if item in &#39;aeiou&#39; else accu)))</span>
<span class="sd">            [&#39;a&#39;, &#39;e&#39;]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">functools</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">bin_op_func</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterator</span><span class="p">,</span> <span class="n">init</span><span class="p">)</span></div>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">reduceby</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">bin_op_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">S</span><span class="p">,</span> <span class="n">T</span><span class="p">],</span> <span class="n">S</span><span class="p">],</span>
        <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">as_dict</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">],</span>
        <span class="n">init</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">S</span><span class="p">,</span> <span class="n">NothingType</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XIterable</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">S</span><span class="p">]]:</span>
        <span class="o">...</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">reduceby</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">bin_op_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">S</span><span class="p">,</span> <span class="n">T</span><span class="p">],</span> <span class="n">S</span><span class="p">],</span>
        <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">__attr_keys1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">*</span><span class="n">attr_keys</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">as_dict</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">],</span>
        <span class="n">init</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">S</span><span class="p">,</span> <span class="n">NothingType</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XIterable</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">S</span><span class="p">]]:</span>
        <span class="o">...</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">reduceby</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">bin_op_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">S</span><span class="p">,</span> <span class="n">T</span><span class="p">],</span> <span class="n">S</span><span class="p">],</span>
        <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">as_dict</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">True</span><span class="p">],</span>
        <span class="n">init</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">S</span><span class="p">,</span> <span class="n">NothingType</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">S</span><span class="p">]:</span>
        <span class="o">...</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">reduceby</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">bin_op_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">S</span><span class="p">,</span> <span class="n">T</span><span class="p">],</span> <span class="n">S</span><span class="p">],</span>
        <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">__attr_keys1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">*</span><span class="n">attr_keys</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">as_dict</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">True</span><span class="p">],</span>
        <span class="n">init</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">S</span><span class="p">,</span> <span class="n">NothingType</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">S</span><span class="p">]:</span>
        <span class="o">...</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">reduceby</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">bin_op_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">S</span><span class="p">,</span> <span class="n">T</span><span class="p">],</span> <span class="n">S</span><span class="p">],</span>
        <span class="n">key</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">K</span><span class="p">],</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">as_dict</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">],</span>
        <span class="n">init</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">S</span><span class="p">,</span> <span class="n">NothingType</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XIterable</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">K</span><span class="p">,</span> <span class="n">S</span><span class="p">]]:</span>
        <span class="o">...</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">reduceby</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">bin_op_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">S</span><span class="p">,</span> <span class="n">T</span><span class="p">],</span> <span class="n">S</span><span class="p">],</span>
        <span class="n">key</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">K</span><span class="p">],</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">as_dict</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">True</span><span class="p">],</span>
        <span class="n">init</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">S</span><span class="p">,</span> <span class="n">NothingType</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="n">K</span><span class="p">,</span> <span class="n">S</span><span class="p">]:</span>
        <span class="o">...</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">reduceby</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">bin_op_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">S</span><span class="p">,</span> <span class="n">T</span><span class="p">],</span> <span class="n">S</span><span class="p">],</span>
        <span class="n">key</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">T</span><span class="p">],</span> <span class="n">K</span><span class="p">],</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">as_dict</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">],</span>
        <span class="n">init</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">S</span><span class="p">,</span> <span class="n">NothingType</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">XIterable</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">K</span><span class="p">,</span> <span class="n">S</span><span class="p">]]:</span>
        <span class="o">...</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">reduceby</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">bin_op_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">S</span><span class="p">,</span> <span class="n">T</span><span class="p">],</span> <span class="n">S</span><span class="p">],</span>
        <span class="n">key</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">T</span><span class="p">],</span> <span class="n">K</span><span class="p">],</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">as_dict</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">True</span><span class="p">],</span>
        <span class="n">init</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">S</span><span class="p">,</span> <span class="n">NothingType</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="n">K</span><span class="p">,</span> <span class="n">S</span><span class="p">]:</span>
        <span class="o">...</span>

<div class="viewcode-block" id="XIterable.reduceby"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.XIterable.reduceby">[docs]</a>    <span class="k">def</span> <span class="nf">reduceby</span><span class="p">(</span>  <span class="c1"># type: ignore[misc] # signatures 2 and 4 are not satified due to inconsistencies with type variables</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">bin_op_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">S</span><span class="p">,</span> <span class="n">T</span><span class="p">],</span> <span class="n">S</span><span class="p">],</span>
        <span class="n">key</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">K</span><span class="p">],</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">T</span><span class="p">],</span> <span class="n">K</span><span class="p">]],</span>
        <span class="o">*</span><span class="n">attr_keys</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">as_dict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">init</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">S</span><span class="p">,</span> <span class="n">NothingType</span><span class="p">]</span> <span class="o">=</span> <span class="n">NOTHING</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span>
        <span class="n">XIterable</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">S</span><span class="p">]],</span>
        <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">S</span><span class="p">],</span>
        <span class="n">XIterable</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">S</span><span class="p">]],</span>
        <span class="n">Dict</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">S</span><span class="p">],</span>
        <span class="n">XIterable</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">K</span><span class="p">,</span> <span class="n">S</span><span class="p">]],</span>
        <span class="n">Dict</span><span class="p">[</span><span class="n">K</span><span class="p">,</span> <span class="n">S</span><span class="p">],</span>
    <span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Group a sequence by a given key and simultaneously perform a reduction inside the groups.</span>

<span class="sd">        More or less equivalent to ``toolz.itertoolz.reduceby(key, bin_op_func, self, init)``</span>
<span class="sd">        with some caveats.</span>

<span class="sd">        The `key` argument is used in the following way:</span>

<span class="sd">            - if `key` is a callable, it will be passed directly to :func:`toolz.itertoolz.reduceby`</span>
<span class="sd">              to compute an actual `key` value for each item in the sequence.</span>
<span class="sd">            - if `key` is a ``str`` or (multiple ``str`` args) they will be used as</span>
<span class="sd">              attributes names (:func:`operator.attrgetter`).</span>
<span class="sd">            - if `key` is a ``list`` of values, they will be used as index values</span>
<span class="sd">              for :func:`operator.itemgetter`.</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            init: initial value for the reduction.</span>
<span class="sd">            as_dict: if `True`, it will return the groups ``dict`` instead of a :class:`XIterable`</span>
<span class="sd">                instance over `groups.items()`.</span>

<span class="sd">        For detailed information check :func:`toolz.itertoolz.reduceby` reference.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; it = xiter([(1.0, -1.0), (1.0,-2.0), (2.2, -3.0)])</span>
<span class="sd">            &gt;&gt;&gt; list(it.reduceby((lambda accu, _: accu + 1), [0], init=0))</span>
<span class="sd">            [(1.0, 2), (2.2, 1)]</span>

<span class="sd">            &gt;&gt;&gt; data = [</span>
<span class="sd">            ...     {&#39;x&#39;: 1.0, &#39;y&#39;: -1.0, &#39;z&#39;: 1.0},</span>
<span class="sd">            ...     {&#39;x&#39;: 1.0, &#39;y&#39;: -2.0, &#39;z&#39;: 1.0},</span>
<span class="sd">            ...     {&#39;x&#39;: 2.2, &#39;y&#39;: -3.0, &#39;z&#39;: 2.2}</span>
<span class="sd">            ... ]</span>
<span class="sd">            &gt;&gt;&gt; list(xiter(data).reduceby((lambda accu, _: accu + 1), [&#39;x&#39;], init=0))</span>
<span class="sd">            [(1.0, 2), (2.2, 1)]</span>
<span class="sd">            &gt;&gt;&gt; list(xiter(data).reduceby((lambda accu, _: accu + 1), [&#39;x&#39;, &#39;z&#39;], init=0))</span>
<span class="sd">            [((1.0, 1.0), 2), ((2.2, 2.2), 1)]</span>

<span class="sd">            &gt;&gt;&gt; from collections import namedtuple</span>
<span class="sd">            &gt;&gt;&gt; Point = namedtuple(&#39;Point&#39;, [&#39;x&#39;, &#39;y&#39;, &#39;z&#39;])</span>
<span class="sd">            &gt;&gt;&gt; data = [Point(1.0, -2.0, 1.0), Point(1.0, -2.0, 1.0), Point(2.2, 3.0, 2.0)]</span>
<span class="sd">            &gt;&gt;&gt; list(xiter(data).reduceby((lambda accu, _: accu + 1), &#39;x&#39;, init=0))</span>
<span class="sd">            [(1.0, 2), (2.2, 1)]</span>
<span class="sd">            &gt;&gt;&gt; list(xiter(data).reduceby((lambda accu, _: accu + 1), &#39;x&#39;, &#39;z&#39;, init=0))</span>
<span class="sd">            [((1.0, 1.0), 2), ((2.2, 2.0), 1)]</span>

<span class="sd">            &gt;&gt;&gt; it = xiter([&#39;Alice&#39;, &#39;Bob&#39;, &#39;Charlie&#39;, &#39;Dan&#39;, &#39;Edith&#39;, &#39;Frank&#39;])</span>
<span class="sd">            &gt;&gt;&gt; list(it.reduceby(lambda nvowels, name: nvowels + sum(i in &#39;aeiou&#39; for i in name), len, init=0))</span>
<span class="sd">            [(5, 4), (3, 2), (7, 3)]</span>

<span class="sd">        &quot;&quot;&quot;</span>  <span class="c1"># noqa: RST203, RST301  # sphinx.napoleon conventions confuse RST validator</span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">callable</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">)))</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">attr_keys</span>
        <span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid &#39;key&#39; function or attribute name: &#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
            <span class="n">groupby_key</span> <span class="o">=</span> <span class="n">key</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">groupby_key</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">Callable</span><span class="p">[[</span><span class="n">T</span><span class="p">],</span> <span class="n">K</span><span class="p">],</span> <span class="n">operator</span><span class="o">.</span><span class="n">itemgetter</span><span class="p">(</span><span class="o">*</span><span class="n">key</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
            <span class="n">groupby_key</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">Callable</span><span class="p">[[</span><span class="n">T</span><span class="p">],</span> <span class="n">K</span><span class="p">],</span> <span class="n">operator</span><span class="o">.</span><span class="n">attrgetter</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="o">*</span><span class="n">attr_keys</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">init</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">NOTHING</span><span class="p">:</span>
            <span class="n">groups</span> <span class="o">=</span> <span class="n">toolz</span><span class="o">.</span><span class="n">itertoolz</span><span class="o">.</span><span class="n">reduceby</span><span class="p">(</span><span class="n">groupby_key</span><span class="p">,</span> <span class="n">bin_op_func</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterator</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="n">init</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">groups</span> <span class="o">=</span> <span class="n">toolz</span><span class="o">.</span><span class="n">itertoolz</span><span class="o">.</span><span class="n">reduceby</span><span class="p">(</span><span class="n">groupby_key</span><span class="p">,</span> <span class="n">bin_op_func</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterator</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">groups</span> <span class="k">if</span> <span class="n">as_dict</span> <span class="k">else</span> <span class="n">xiter</span><span class="p">(</span><span class="n">groups</span><span class="o">.</span><span class="n">items</span><span class="p">())</span></div>

<div class="viewcode-block" id="XIterable.to_list"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.XIterable.to_list">[docs]</a>    <span class="k">def</span> <span class="nf">to_list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Expand iterator into a ``list``.</span>

<span class="sd">        Equivalent to ``list(self)``.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; it = xiter(range(5))</span>
<span class="sd">            &gt;&gt;&gt; it.to_list()</span>
<span class="sd">            [0, 1, 2, 3, 4]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iterator</span><span class="p">)</span></div>

<div class="viewcode-block" id="XIterable.to_set"><a class="viewcode-back" href="../../../_source/gt4py.eve.html#gt4py.eve.utils.XIterable.to_set">[docs]</a>    <span class="k">def</span> <span class="nf">to_set</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Expand iterator into a ``set``.</span>

<span class="sd">        Equivalent to ``set(self)``.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; it = xiter([1, 2, 3, 1, 3, -1])</span>
<span class="sd">            &gt;&gt;&gt; it.to_set()</span>
<span class="sd">            {1, 2, 3, -1}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iterator</span><span class="p">)</span></div></div>


<span class="n">xiter</span> <span class="o">=</span> <span class="n">XIterable</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2014-2022, ETH Zurich.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>