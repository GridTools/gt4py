# ---- Build system ----
[build-system]
build-backend = "setuptools.build_meta"
requires = ["setuptools>=60.6", "wheel", "cython"]

# ---- Project description ----
# -- Standard options (PEP 621) --
[project]
name = "gt4py"
authors = [{ name = "ETH Zurich", email = "gridtools@cscs.ch" }]
description = "Python library for generating high-performance implementations of stencil kernels for weather and climate modeling from a domain-specific language (DSL)"
readme = "README.md"
requires-python = ">=3.8"
keywords = [
  "gridtools",
  "stencil",
  "weather",
  "climate",
  "performance",
  "portable",
  "hpc",
]
license = { text = "GPL-3.0-or-later" }
classifiers = [
  "Development Status :: 4 - Beta",
  "Environment :: Console",
  "Environment :: GPU :: NVIDIA CUDA",
  "Intended Audience :: Science/Research",
  "License :: OSI Approved :: GNU General Public License v3 or later (GPLv3+)",
  "Operating System :: POSIX",
  "Programming Language :: Python",
  "Programming Language :: Python :: 3.8",
  "Programming Language :: Python :: 3.9",
  "Programming Language :: Python :: 3.10",
  "Programming Language :: Python :: Implementation :: CPython",
  "Topic :: Scientific/Engineering :: Atmospheric Science",
  "Topic :: Scientific/Engineering :: Mathematics",
  "Topic :: Scientific/Engineering :: Physics",
]
dependencies = [
  "astunparse>=1.6.3;python_version<'3.9'",
  "attrs>=21.3",
  "black>=22.3",
  "boltons>=20.0",
  "cached-property>=1.5",
  "click>=7.1",
  "cmake>=3.22",
  "cytoolz>=0.11",
  "deepdiff>=5.8",
  "devtools>=0.6",
  "frozendict>=2.3",
  "gridtools-cpp>=2.2.3,==2.*",
  "jinja2>=2.10",
  "lark>=1.1.2",
  "mako>=1.1",
  "networkx>=2.4",
  "ninja>=1.10",
  "numpy>=1.15",
  "packaging>=20.0",
  "pybind11>=2.5",
  "scipy>=1.4",
  "setuptools>=60.6",
  "tabulate>=0.8",
  "toolz>=0.11",
  "typing-extensions>=4.2",
  "xxhash>=1.4.4,<3.1.0",
]
dynamic = ["version"]

[project.optional-dependencies]
cuda = ["cupy"]
cuda110 = ["cupy-cuda110"]
cuda111 = ["cupy-cuda111"]
cuda112 = ["cupy-cuda112"]
cuda113 = ["cupy-cuda113"]
cuda114 = ["cupy-cuda114"]
cuda115 = ["cupy-cuda115"]
cuda116 = ["cupy-cuda116"]
cuda117 = ["cupy-cuda117"]
cuda11x = ["cupy-cuda11x"]
dace = ["dace>=0.14.2,<0.15", "sympy"]
formatting = ["clang-format>=9.0"]
testing = ["hypothesis>=4.14", "pytest>=6.1"]

[project.scripts]
gtpyc = "gt4py.cartesian.cli:gtpyc"

[project.urls]
Homepage = "https://gridtools.github.io/"
Documentation = "https://gridtools.github.io/gt4py"
Source = "https://github.com/GridTools/gt4py"

# -- Setuptools-specific --
[tool.setuptools]
platforms = ["Linux", "Mac"]
zip-safe = false

[tool.setuptools.dynamic]
version = { attr = "gt4py.__about__.__version__" }

[tool.setuptools.packages]
find = { namespaces = false, where = ["src"] }

[tool.setuptools.package-data]
gt4py = [ "py.typed", "*.in", "*.md", "*.rst", "*.toml", "*.txt"]

# ---- Other tools ----
# -- black --
[tool.black]
exclude = '''
/(
    \.git
  | \.gt_cache
  | \.hg
  | \.mypy_cache
  | \.tox
  | \.venv
  | _build
  | buck-out
  | build
  | dist
)/
'''
include = '\.pyi?$'
line-length = 100
target_version = ["py310"]

